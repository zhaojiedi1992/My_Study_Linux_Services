

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>15.1. docker基础 &mdash; My_Study_Linux_Services v0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="My_Study_Linux_Services v0.1 documentation" href="../index.html"/>
        <link rel="up" title="15. 容器" href="index.html"/>
        <link rel="next" title="16. 虚拟化" href="../虚拟化/index.html"/>
        <link rel="prev" title="15. 容器" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/baidu.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> My_Study_Linux_Services
          

          
          </a>

          
            
            
              <div class="version">
                v0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Linux基础服务</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../DHCP/index.html">1. dhcp服务</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Rsync同步/index.html">2. Rsync同步</a></li>
<li class="toctree-l1"><a class="reference internal" href="../自动化安装/index.html">3. 自动化安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="../自动化运维/index.html">4. 自动化运维</a></li>
<li class="toctree-l1"><a class="reference internal" href="../安全和监控/index.html">5. 安全和监控</a></li>
<li class="toctree-l1"><a class="reference internal" href="../远程登陆/index.html">6. 远程登陆</a></li>
<li class="toctree-l1"><a class="reference internal" href="../认证/index.html">7. 认证</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DNS/index.html">8. DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../数据库/index.html">9. 数据库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEB/index.html">10. WEB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../日志管理/index.html">11. 日志管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../网络文件共享/index.html">12. 网络文件共享</a></li>
<li class="toctree-l1"><a class="reference internal" href="../版本控制/index.html">13. 版本控制</a></li>
<li class="toctree-l1"><a class="reference internal" href="../集群/index.html">14. 集群</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">15. 容器</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">15.1. docker基础</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">15.1.1. docker安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">15.1.2. docker基础信息获取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">15.1.3. docker常用命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="#docker-run">15.1.4. docker run常用命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">15.1.5. docker拉取和分发</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">15.1.5.1. docker加速器配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pull">15.1.5.2. 镜像拉取(pull)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#push">15.1.5.3. 镜像推送(push)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#save">15.1.5.4. 镜像保存(save)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load">15.1.5.5. 镜像加载(load)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#docker-volumes">15.1.6. docker卷(Volumes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">15.1.7. docker网络</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">15.1.7.1. 查看网络列表</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bridge">15.1.7.2. bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#closed">15.1.7.3. closed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#joined">15.1.7.4. joined</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opened">15.1.7.5. opened</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">15.1.7.6. docker端口映射</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../虚拟化/index.html">16. 虚拟化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../杂项/index.html">17. 杂项</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">My_Study_Linux_Services</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">15. 容器</a> &raquo;</li>
        
      <li>15.1. docker基础</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/zhaojiedi1992/My_Study_Linux_Services/blob/../edit/master/source/容器/01-docker基础.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="docker">
<h1>15.1. docker基础<a class="headerlink" href="#docker" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>15.1.1. docker安装<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># cd /etc/yum.repos.d/</span>
<span class="o">[</span>root@centos-151 yum.repos.d<span class="o">]</span><span class="c1"># ls</span>
bak  CentOS-Base.repo  epel.repo  mariadb.repo.bak
<span class="o">[</span>root@centos-151 yum.repos.d<span class="o">]</span><span class="c1"># wget http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span>

<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># yum install docker</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># systemctl enable docker</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># systemctl start docker</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>15.1.2. docker基础信息获取<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>获取version</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker version</span>
Client:
Version:         <span class="m">1</span>.13.1
API version:     <span class="m">1</span>.26
Package version: &lt;unknown&gt;
Go version:      go1.8.3
Git commit:      774336d/1.13.1
Built:           Wed Mar  <span class="m">7</span> <span class="m">17</span>:06:16 <span class="m">2018</span>
OS/Arch:         linux/amd64

Server:
Version:         <span class="m">1</span>.13.1
API version:     <span class="m">1</span>.26 <span class="o">(</span>minimum version <span class="m">1</span>.12<span class="o">)</span>
Package version: &lt;unknown&gt;
Go version:      go1.8.3
Git commit:      774336d/1.13.1
Built:           Wed Mar  <span class="m">7</span> <span class="m">17</span>:06:16 <span class="m">2018</span>
OS/Arch:         linux/amd64
Experimental:    <span class="nb">false</span>
</pre></div>
</div>
<p>获取info</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>[root@centos-151 ~]# docker info
Containers: 0
Running: 0
Paused: 0
Stopped: 0
Images: 0
Server Version: 1.13.1
Storage Driver: overlay2
Backing Filesystem: xfs
Supports d_type: true
Native Overlay Diff: true
Logging Driver: journald
Cgroup Driver: systemd
Plugins:
Volume: local
Network: bridge host macvlan null overlay
Swarm: inactive
Runtimes: docker-runc runc
Default Runtime: docker-runc
Init Binary: docker-init
containerd version:  (expected: aa8187dbd3b7ad67d8e5e3a15115d3eef43a7ed1)
runc version: N/A (expected: 9df8b306d01f59d3a8029be411de015b7304dd8f)
init version: N/A (expected: 949e6facb77383876aeff8a6944dde66b3089574)
Security Options:
seccomp
WARNING: You&#39;re not using the default seccomp profile
Profile: /etc/docker/seccomp.json
Kernel Version: 3.10.0-693.el7.x86_64
Operating System: CentOS Linux 7 (Core)
OSType: linux
Architecture: x86_64
Number of Docker Hooks: 3
CPUs: 1
Total Memory: 506.3 MiB
Name: centos-151.linuxpanda.tech
ID: QQNH:77EU:CBH7:NHX4:A5H4:4PEA:YJBK:EFXQ:VCOP:C2YL:QH7O:Q7XE
Docker Root Dir: /var/lib/docker
Debug Mode (client): false
Debug Mode (server): false
Registry: https://index.docker.io/v1/
WARNING: bridge-nf-call-iptables is disabled
WARNING: bridge-nf-call-ip6tables is disabled
Experimental: false
Insecure Registries:
127.0.0.0/8
Live Restore Enabled: false
Registries: docker.io (secure)
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>15.1.3. docker常用命令<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre><span></span>docker run 运行一个容器
docker create 创建，需要在配合start命令
docker start 启动一个创建好的容器
docker stop 停止容器
docker kill 杀掉容器
docker restart 重启容器
docker pause   暂停容器
docker search  查询registry的相关镜像
docker pull  从registry拉取镜像
docker push  推送到registry
docker save  保存成压缩包
docker load  从压缩包加载进来
docker log  查看日志信息
docker info  查看docker信息
docker version 查看docker版本
docker inspect 查看镜像容器信息
docker images 查看已有镜像信息
docker rm     删除容器
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker</span>
build      diff       <span class="nb">history</span>    inspect    logs       port       restart    search     stats      top        <span class="nb">wait</span>
commit     events     image      <span class="nb">kill</span>       network    ps         rm         secret     stop       unpause
container  <span class="nb">exec</span>       images     load       node       pull       rmi        service    swarm      update
cp         <span class="nb">export</span>     import     login      pause      push       run        stack      system     version
create     <span class="nb">help</span>       info       <span class="nb">logout</span>     plugin     rename     save       start      tag        volume
</pre></div>
</div>
</div>
<div class="section" id="docker-run">
<h2>15.1.4. docker run常用命令<a class="headerlink" href="#docker-run" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre><span></span>[root@centos-151 ~]# docker help run

Usage:      docker run [OPTIONS] IMAGE [COMMAND] [ARG...]

Run a command in a new container

Options:
    --add-host list                         Add a custom host-to-IP mapping (host:ip) (default [])
-a, --attach list                           Attach to STDIN, STDOUT or STDERR (default [])
    --blkio-weight uint16                   Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)
    --blkio-weight-device weighted-device   Block IO weight (relative device weight) (default [])
    --cap-add list                          Add Linux capabilities (default [])
    --cap-drop list                         Drop Linux capabilities (default [])
    --cgroup-parent string                  Optional parent cgroup for the container
    --cidfile string                        Write the container ID to the file
    --cpu-count int                         CPU count (Windows only)
    --cpu-percent int                       CPU percent (Windows only)
    --cpu-period int                        Limit CPU CFS (Completely Fair Scheduler) period
    --cpu-quota int                         Limit CPU CFS (Completely Fair Scheduler) quota
    --cpu-rt-period int                     Limit CPU real-time period in microseconds
    --cpu-rt-runtime int                    Limit CPU real-time runtime in microseconds
-c, --cpu-shares int                        CPU shares (relative weight)
    --cpus decimal                          Number of CPUs (default 0.000)
    --cpuset-cpus string                    CPUs in which to allow execution (0-3, 0,1)
    --cpuset-mems string                    MEMs in which to allow execution (0-3, 0,1)
    --credentialspec string                 Credential spec for managed service account (Windows only)
-d, --detach                                Run container in background and print container ID
    --detach-keys string                    Override the key sequence for detaching a container
    --device list                           Add a host device to the container (default [])
    --device-read-bps throttled-device      Limit read rate (bytes per second) from a device (default [])
    --device-read-iops throttled-device     Limit read rate (IO per second) from a device (default [])
    --device-write-bps throttled-device     Limit write rate (bytes per second) to a device (default [])
    --device-write-iops throttled-device    Limit write rate (IO per second) to a device (default [])
    --disable-content-trust                 Skip image verification (default true)
    --dns list                              Set custom DNS servers (default [])
    --dns-option list                       Set DNS options (default [])
    --dns-search list                       Set custom DNS search domains (default [])
    --entrypoint string                     Overwrite the default ENTRYPOINT of the image
-e, --env list                              Set environment variables (default [])
    --env-file list                         Read in a file of environment variables (default [])
    --expose list                           Expose a port or a range of ports (default [])
    --group-add list                        Add additional groups to join (default [])
    --health-cmd string                     Command to run to check health
    --health-interval duration              Time between running the check (ns|us|ms|s|m|h) (default 0s)
    --health-retries int                    Consecutive failures needed to report unhealthy
    --health-timeout duration               Maximum time to allow one check to run (ns|us|ms|s|m|h) (default 0s)
    --help                                  Print usage
-h, --hostname string                       Container host name
    --init                                  Run an init inside the container that forwards signals and reaps processes
    --init-path string                      Path to the docker-init binary
-i, --interactive                           Keep STDIN open even if not attached
    --io-maxbandwidth string                Maximum IO bandwidth limit for the system drive (Windows only)
    --io-maxiops uint                       Maximum IOps limit for the system drive (Windows only)
    --ip string                             Container IPv4 address (e.g. 172.30.100.104)
    --ip6 string                            Container IPv6 address (e.g. 2001:db8::33)
    --ipc string                            IPC namespace to use
    --isolation string                      Container isolation technology
    --kernel-memory string                  Kernel memory limit
-l, --label list                            Set meta data on a container (default [])
    --label-file list                       Read in a line delimited file of labels (default [])
    --link list                             Add link to another container (default [])
    --link-local-ip list                    Container IPv4/IPv6 link-local addresses (default [])
    --log-driver string                     Logging driver for the container
    --log-opt list                          Log driver options (default [])
    --mac-address string                    Container MAC address (e.g. 92:d0:c6:0a:29:33)
-m, --memory string                         Memory limit
    --memory-reservation string             Memory soft limit
    --memory-swap string                    Swap limit equal to memory plus swap: &#39;-1&#39; to enable unlimited swap
    --memory-swappiness int                 Tune container memory swappiness (0 to 100) (default -1)
    --name string                           Assign a name to the container
    --network string                        Connect a container to a network (default &quot;default&quot;)
    --network-alias list                    Add network-scoped alias for the container (default [])
    --no-healthcheck                        Disable any container-specified HEALTHCHECK
    --oom-kill-disable                      Disable OOM Killer
    --oom-score-adj int                     Tune host&#39;s OOM preferences (-1000 to 1000)
    --pid string                            PID namespace to use
    --pids-limit int                        Tune container pids limit (set -1 for unlimited)
    --privileged                            Give extended privileges to this container
-p, --publish list                          Publish a container&#39;s port(s) to the host (default [])
-P, --publish-all                           Publish all exposed ports to random ports
    --read-only                             Mount the container&#39;s root filesystem as read only
    --restart string                        Restart policy to apply when a container exits (default &quot;no&quot;)
    --rm                                    Automatically remove the container when it exits
    --runtime string                        Runtime to use for this container
    --security-opt list                     Security Options (default [])
    --shm-size string                       Size of /dev/shm, default value is 64MB
    --sig-proxy                             Proxy received signals to the process (default true)
    --stop-signal string                    Signal to stop a container, SIGTERM by default (default &quot;SIGTERM&quot;)
    --stop-timeout int                      Timeout (in seconds) to stop a container
    --storage-opt list                      Storage driver options for the container (default [])
    --sysctl map                            Sysctl options (default map[])
    --tmpfs list                            Mount a tmpfs directory (default [])
-t, --tty                                   Allocate a pseudo-TTY
    --ulimit ulimit                         Ulimit options (default [])
-u, --user string                           Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])
    --userns string                         User namespace to use
    --uts string                            UTS namespace to use
-v, --volume list                           Bind mount a volume (default [])
    --volume-driver string                  Optional volume driver for the container
    --volumes-from list                     Mount volumes from the specified container(s) (default [])
-w, --workdir string                        Working directory inside the container

# 上面就是获取run子命令的方法， 常用的选项是下面几个
-i： 交互模式
-t： 分配终端
-v： 卷设置
-p： 端口配置
-h： 主机名
-a： 附加
-e:  环境变量
--rm: 停掉容器就删除
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>15.1.5. docker拉取和分发<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>在拉取和分发之前需要配置下docker加速,因为默认是从dockerhub上拉取的，太慢了。</p>
<div class="section" id="id5">
<h3>15.1.5.1. docker加速器配置<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/进入加速器配置.png" src="../_images/进入加速器配置.png" />
<img alt="../_images/加速器配置.png" src="../_images/加速器配置.png" />
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># sudo mkdir -p /etc/docker</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># sudo tee /etc/docker/daemon.json &lt;&lt;-&#39;EOF&#39;</span>
&gt; <span class="o">{</span>
&gt;   <span class="s2">&quot;registry-mirrors&quot;</span>: <span class="o">[</span><span class="s2">&quot;https://mdobwrbd.mirror.aliyuncs.com&quot;</span><span class="o">]</span>
&gt; <span class="o">}</span>
&gt; EOF
<span class="o">{</span>
<span class="s2">&quot;registry-mirrors&quot;</span>: <span class="o">[</span><span class="s2">&quot;https://mdobwrbd.mirror.aliyuncs.com&quot;</span><span class="o">]</span>
<span class="o">}</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># sudo systemctl daemon-reload</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># sudo systemctl restart docker</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># cat /etc/docker/daemon.json</span>
<span class="o">{</span>
<span class="s2">&quot;registry-mirrors&quot;</span>: <span class="o">[</span><span class="s2">&quot;https://mdobwrbd.mirror.aliyuncs.com&quot;</span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">上面的加速地址，是阿里云给我分配的加速地址，如果没有阿里云的账号，可以使用docker中国的加速器，地址为https://registry.docker-cn.com</p>
</div>
</div>
<div class="section" id="pull">
<h3>15.1.5.2. 镜像拉取(pull)<a class="headerlink" href="#pull" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker pull alpine</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker pull busybox</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker pull cirros</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker pull centos</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker image ls</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
docker.io/busybox   latest              2716f21dc1e3        <span class="m">33</span> hours ago        <span class="m">1</span>.15 MB
docker.io/centos    latest              2d194b392dd1        <span class="m">4</span> weeks ago         <span class="m">195</span> MB
docker.io/alpine    latest              3fd9065eaf02        <span class="m">2</span> months ago        <span class="m">4</span>.15 MB
docker.io/cirros    latest              a5e21e1957b6        <span class="m">5</span> months ago        <span class="m">7</span>.74 MB

<span class="c1"># 运行一个容器</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run -it busybox</span>
/ <span class="c1"># ls</span>
bin   dev   etc   home  proc  root  run   sys   tmp   usr   var
/ <span class="c1"># ifconfig</span>
eth0      Link encap:Ethernet  HWaddr <span class="m">02</span>:42:AC:11:00:02
        inet addr:172.17.0.2  Bcast:0.0.0.0  Mask:255.255.0.0
        inet6 addr: fe80::42:acff:fe11:2/64 Scope:Link
        UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
        RX packets:16 errors:0 dropped:0 overruns:0 frame:0
        TX packets:8 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:0
        RX bytes:1296 <span class="o">(</span><span class="m">1</span>.2 KiB<span class="o">)</span>  TX bytes:648 <span class="o">(</span><span class="m">648</span>.0 B<span class="o">)</span>

lo        Link encap:Local Loopback
        inet addr:127.0.0.1  Mask:255.0.0.0
        inet6 addr: ::1/128 Scope:Host
        UP LOOPBACK RUNNING  MTU:65536  Metric:1
        RX packets:0 errors:0 dropped:0 overruns:0 frame:0
        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:1
        RX bytes:0 <span class="o">(</span><span class="m">0</span>.0 B<span class="o">)</span>  TX bytes:0 <span class="o">(</span><span class="m">0</span>.0 B<span class="o">)</span>

<span class="c1"># 查看运行的容器信息</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
7913587953d5        busybox             <span class="s2">&quot;sh&quot;</span>                <span class="m">8</span> seconds ago       Up <span class="m">8</span> seconds                            goofy_feynman
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker ps -a</span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                          PORTS               NAMES
7913587953d5        busybox             <span class="s2">&quot;sh&quot;</span>                <span class="m">51</span> seconds ago      Exited <span class="o">(</span><span class="m">130</span><span class="o">)</span> <span class="m">6</span> seconds ago                          goofy_feynman
1d60bcd49b65        busybox             <span class="s2">&quot;sh&quot;</span>                <span class="m">4</span> minutes ago       Exited <span class="o">(</span><span class="m">0</span><span class="o">)</span> About a minute ago                       inspiring_colden
</pre></div>
</div>
</div>
<div class="section" id="push">
<h3>15.1.5.3. 镜像推送(push)<a class="headerlink" href="#push" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span># 拉取镜像
[root@centos-151 ~]# docker pull nginx:1.12-alpine

# 运行镜像
[root@centos-151 ~]# docker run --name nginx1 -d nginx:1.12-alpine
88fd050b758c611fe7e1972ffd5c673fd957838b9f60e31e531019e86ef8481b
# 查看
[root@centos-151 ~]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
88fd050b758c        nginx:1.12-alpine   &quot;nginx -g &#39;daemon ...&quot;   7 seconds ago       Up 6 seconds        80/tcp              nginx1

[root@centos-151 ~]# docker help exec
[root@centos-151 ~]# docker exec -it nginx1 /bin/sh
/ # ls
bin    dev    etc    home   lib    media  mnt    proc   root   run    sbin   srv    sys    tmp    usr    var
/ # cd /etc/nginx/
/etc/nginx # vim nginx.conf
/bin/sh: vim: not found
/etc/nginx # ls
conf.d                  fastcgi_params          koi-win                 modules                 scgi_params             uwsgi_params.default
fastcgi.conf            fastcgi_params.default  mime.types              nginx.conf              scgi_params.default     win-utf
fastcgi.conf.default    koi-utf                 mime.types.default      nginx.conf.default      uwsgi_params
/etc/nginx # cd conf.d/
/etc/nginx/conf.d # ls
default.conf
/etc/nginx/conf.d # vi default.conf
# 添加一个location
location /test {
        root /data/html ;
        index index.html;
    }
/etc/nginx/conf.d # echo &quot;hello linuxpanda.tech &quot; &gt; /data/html/test/index.html
/bin/sh: can&#39;t create /data/html/test/index.html: nonexistent directory
/etc/nginx/conf.d # mkdir /data/html/test  -pv
/etc/nginx/conf.d # echo &quot;hello linuxpanda.tech &quot; &gt; /data/html/test/index.html
</pre></div>
</div>
<p>准备下阿里云相关的配置</p>
<img alt="../_images/创建镜像仓库.png" src="../_images/创建镜像仓库.png" />
<img alt="../_images/配置镜像仓库.png" src="../_images/配置镜像仓库.png" />
<img alt="../_images/管理.png" src="../_images/管理.png" />
<img alt="../_images/镜像管理详细页面.png" src="../_images/镜像管理详细页面.png" />
<img alt="../_images/版本情况.png" src="../_images/版本情况.png" />
<p>在另一个主机上面pull下来，测试</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-152 docker<span class="o">]</span><span class="c1"># docker pull registry.cn-beijing.aliyuncs.com/zhaojiedi1992/test:v1</span>
<span class="o">[</span>root@centos-152 docker<span class="o">]</span><span class="c1"># docker image ls</span>
REPOSITORY                                            TAG                 IMAGE ID            CREATED             SIZE
registry.cn-beijing.aliyuncs.com/zhaojiedi1992/test   v1                  f51a8135583c        <span class="m">27</span> minutes ago      <span class="m">15</span>.5 MB
<span class="o">[</span>root@centos-152 docker<span class="o">]</span><span class="c1"># docker run --name nginx02 -d f51a8135583c</span>
39b4d5747dc24a40509011c9b33e21435d6798ee8d113a438183808d1a3bf259
<span class="o">[</span>root@centos-152 docker<span class="o">]</span><span class="c1"># curl 172.17.0.2/test/</span>
hello linuxpanda.tech
</pre></div>
</div>
</div>
<div class="section" id="save">
<h3>15.1.5.4. 镜像保存(save)<a class="headerlink" href="#save" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 yum.repos.d<span class="o">]</span><span class="c1"># docker save busybox alpine | gzip &gt; tree.tgz</span>
<span class="o">[</span>root@centos-151 yum.repos.d<span class="o">]</span><span class="c1"># scp tree.tgz  192.168.46.152:/root</span>
</pre></div>
</div>
</div>
<div class="section" id="load">
<h3>15.1.5.5. 镜像加载(load)<a class="headerlink" href="#load" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-152 ~<span class="o">]</span><span class="c1"># docker help load</span>
<span class="o">[</span>root@centos-152 ~<span class="o">]</span><span class="c1"># docker image load -i tree.tgz</span>
3e596351c689: Loading layer <span class="o">[==================================================</span>&gt;<span class="o">]</span>  <span class="m">1</span>.36 MB/1.36 MB
Loaded image: docker.io/busybox:latest
cd7100a72410: Loading layer <span class="o">[==================================================</span>&gt;<span class="o">]</span> <span class="m">4</span>.403 MB/4.403 MB
Loaded image: docker.io/alpine:latest
<span class="o">[</span>root@centos-152 ~<span class="o">]</span><span class="c1"># docker image ls</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
docker.io/busybox   latest              2716f21dc1e3        <span class="m">37</span> hours ago        <span class="m">1</span>.15 MB
docker.io/alpine    latest              3fd9065eaf02        <span class="m">2</span> months ago        <span class="m">4</span>.15 MB
</pre></div>
</div>
</div>
</div>
<div class="section" id="docker-volumes">
<h2>15.1.6. docker卷(Volumes)<a class="headerlink" href="#docker-volumes" title="Permalink to this headline">¶</a></h2>
<p>docker的卷分为2种</p>
<ul class="simple">
<li>bind挂载卷</li>
<li>docker自管理卷</li>
</ul>
</div>
<div class="section" id="id6">
<h2>15.1.7. docker网络<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>docker的网络分为四种</p>
<ul class="simple">
<li>closed: 封闭的， 只有lo本地回环网卡</li>
<li>bridged: 桥接，这是默认的</li>
<li>joined: 连接的，多个docker公用一个network命名空间</li>
<li>opened: 开放的，和宿主机一个命名空间</li>
</ul>
<div class="section" id="id7">
<h3>15.1.7.1. 查看网络列表<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker network ls</span>
NETWORK ID          NAME                DRIVER              SCOPE
e00b7e276b12        bridge              bridge              <span class="nb">local</span>
42c62865be61        host                host                <span class="nb">local</span>
ccb7572950be        none                null                <span class="nb">local</span>
</pre></div>
</div>
</div>
<div class="section" id="bridge">
<h3>15.1.7.2. bridge<a class="headerlink" href="#bridge" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run --name busybox10 -it busybox</span>
/ <span class="c1"># ifconfig</span>
eth0      Link encap:Ethernet  HWaddr <span class="m">02</span>:42:AC:11:00:05
        inet addr:172.17.0.5  Bcast:0.0.0.0  Mask:255.255.0.0
        inet6 addr: fe80::42:acff:fe11:5/64 Scope:Link
        UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
        RX packets:6 errors:0 dropped:0 overruns:0 frame:0
        TX packets:6 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:0
        RX bytes:508 <span class="o">(</span><span class="m">508</span>.0 B<span class="o">)</span>  TX bytes:508 <span class="o">(</span><span class="m">508</span>.0 B<span class="o">)</span>

lo        Link encap:Local Loopback
        inet addr:127.0.0.1  Mask:255.0.0.0
        inet6 addr: ::1/128 Scope:Host
        UP LOOPBACK RUNNING  MTU:65536  Metric:1
        RX packets:0 errors:0 dropped:0 overruns:0 frame:0
        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:1
        RX bytes:0 <span class="o">(</span><span class="m">0</span>.0 B<span class="o">)</span>  TX bytes:0 <span class="o">(</span><span class="m">0</span>.0 B<span class="o">)</span>

/ <span class="c1"># ^C</span>
/ <span class="c1"># exit</span>
</pre></div>
</div>
</div>
<div class="section" id="closed">
<h3>15.1.7.3. closed<a class="headerlink" href="#closed" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run --name busybox11 -it --network none busybox</span>
/ <span class="c1"># ifconfig</span>
lo        Link encap:Local Loopback
        inet addr:127.0.0.1  Mask:255.0.0.0
        inet6 addr: ::1/128 Scope:Host
        UP LOOPBACK RUNNING  MTU:65536  Metric:1
        RX packets:0 errors:0 dropped:0 overruns:0 frame:0
        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:1
        RX bytes:0 <span class="o">(</span><span class="m">0</span>.0 B<span class="o">)</span>  TX bytes:0 <span class="o">(</span><span class="m">0</span>.0 B<span class="o">)</span>

/ <span class="c1"># exit</span>
</pre></div>
</div>
</div>
<div class="section" id="joined">
<h3>15.1.7.4. joined<a class="headerlink" href="#joined" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run --name nginx11 -d  --rm nginx:1.12-alpine</span>
cf5e89cddf175152472d25d51d52ae1e136bc5887682f24203bb178487674103
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker inspect  nginx11 |grep -i ipa</span>
            <span class="s2">&quot;SecondaryIPAddresses&quot;</span>: null,
            <span class="s2">&quot;IPAddress&quot;</span>: <span class="s2">&quot;172.17.0.5&quot;</span>,
                    <span class="s2">&quot;IPAMConfig&quot;</span>: null,
                    <span class="s2">&quot;IPAddress&quot;</span>: <span class="s2">&quot;172.17.0.5&quot;</span>,
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run --name busybox12 --rm -it --network container:nginx11 busybox</span>
/ <span class="c1"># curl localhost</span>
sh: curl: not found
/ <span class="c1"># wget localhost</span>
Connecting to localhost <span class="o">(</span><span class="m">127</span>.0.0.1:80<span class="o">)</span>
index.html           <span class="m">100</span>% <span class="p">|</span>**************************************************************************************************************************************************<span class="p">|</span>   <span class="m">612</span>   <span class="m">0</span>:00:00 ETA
/ <span class="c1"># cat index.html</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body <span class="o">{</span>
        width: 35em<span class="p">;</span>
        margin: <span class="m">0</span> auto<span class="p">;</span>
        font-family: Tahoma, Verdana, Arial, sans-serif<span class="p">;</span>
    <span class="o">}</span>
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nginx.org/&quot;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nginx.com/&quot;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you <span class="k">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
</div>
<div class="section" id="opened">
<h3>15.1.7.5. opened<a class="headerlink" href="#opened" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run --name nginx15 -d  --network host nginx:1.12-alpine</span>
f0fd0f9069cab8126c53cde3baa8d76a94e89abd709a7864b96bfeb400628677
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker inspect nginx15 |grep -i ipa</span>
            <span class="s2">&quot;SecondaryIPAddresses&quot;</span>: null,
            <span class="s2">&quot;IPAddress&quot;</span>: <span class="s2">&quot;&quot;</span>,
                    <span class="s2">&quot;IPAMConfig&quot;</span>: null,
                    <span class="s2">&quot;IPAddress&quot;</span>: <span class="s2">&quot;&quot;</span>,
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># curl localhost</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body <span class="o">{</span>
        width: 35em<span class="p">;</span>
        margin: <span class="m">0</span> auto<span class="p">;</span>
        font-family: Tahoma, Verdana, Arial, sans-serif<span class="p">;</span>
    <span class="o">}</span>
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nginx.org/&quot;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nginx.com/&quot;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you <span class="k">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>15.1.7.6. docker端口映射<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker run --name nginx17 -d  -p 80:80 nginx:1.12-alpine</span>
dda9ec45687aa71d552a32e65bb7d703a1b2170ea57416543a67e2055e1f5052


<span class="o">[</span>root@centos-152 ~<span class="o">]</span><span class="c1"># clear</span>
<span class="o">[</span>root@centos-152 ~<span class="o">]</span><span class="c1"># curl 192.168.46.151</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body <span class="o">{</span>
        width: 35em<span class="p">;</span>
        margin: <span class="m">0</span> auto<span class="p">;</span>
        font-family: Tahoma, Verdana, Arial, sans-serif<span class="p">;</span>
    <span class="o">}</span>
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nginx.org/&quot;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nginx.com/&quot;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you <span class="k">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

<span class="c1">#查看映射</span>
<span class="o">[</span>root@centos-151 ~<span class="o">]</span><span class="c1"># docker port nginx17</span>
<span class="m">80</span>/tcp -&gt; <span class="m">0</span>.0.0.0:80
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../虚拟化/index.html" class="btn btn-neutral float-right" title="16. 虚拟化" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="15. 容器" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, zhaojiedi1992.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>  个人博客 <a href="http://www.linuxpanda.tech/topic/"> LinuxPanda </a> . 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>